---
title: "VBA - script for deleteing all hidden rows and columns and converting formulas in an excel workbook to values across all worksheets"
author: "Leon Shpaner"
date: 2020-11-13
output: html_document
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>Copy the following code into the VBA Environment in excel:</p>
<p><br></p>
<html>
<style>
p.indent {
    text-indent: 30px;
}

div.a {
  line-height:130%;
}


</style>
</head>
<body>
<div class="a">
<p style="font-family:consolas">
<p><font color = blue> Sub </font color> DeleteHidden_ConvertToValuesAllWorksheets()</p>
<p>        <font color = blue> Dim</font color> ws <font color=blue> As</font color> Worksheet, rng </font color> <font color=blue> As </font color> Range
<br>          <font color=blue> For Each </font color> ws <font color=blue> In </font color> ActiveWorkbook.Worksheets
<br>          <font color=blue> For Each </font color> rng <font color=blue> In </font color> ws.UsedRange
<br>                 <font color=blue> If </font color> rng.HasFormula <font color=blue> Then </font color>
<br>                 rng.Formula = rng.Value
<br>          <font color=blue> End If </font color>
<br>                 <font color=blue> Next </font color> rng
<br>                 <font color=blue> Next </font color> ws</p>
<p><font color=green> ' delete all Hidden rows-columns in all sheets </font color></p>
<p>         <font color=blue> Dim </font color> r <font color=blue> As Long </font color>, c <font color=blue> As Long </font color>, x <font color=blue> As Long </font color>
<br>          Application.ScreenUpdating = <font color=blue> False </font color></p>
<p>         <font color=blue> For Each </font color> ws <font color=blue> In </font color> Sheets</p>
<p>r = ws.Cells.Find(What:="*", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row
<br> c = ws.Cells.Find(What:="*", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column</p>
<p>         <font color=blue> For </font color> x = r <font color=blue> To </font color> 1 <font color=blue> Step </font color> -1
<br>          <font color=blue> If </font color> ws.Rows(x).Hidden = <font color=blue> True </font color> <font color=blue> Then </font color> ws.Rows(x).Delete
<br> <font color=blue> Next </font color>
<br>          <font color=blue> For </font color> x = c <font color=blue> To </font color> 1 <font color=blue> Step </font color> -1
<br>          <font color=blue> If </font color> ws.Columns(x).Hidden = <font color=blue> True </font color> <font color=blue> Then </font color> ws.Columns(x).Delete</p>
<p><font color=blue> Next </font color></p>
<p><font color=blue> Next </font color></p>
<p>Application.ScreenUpdating = <font color=blue> True </font color></p>
<p><font color = blue> End Sub </font color></p>
</p>
</div>
</body>
</html>
