---
title: "VBA - script for converting formulas in an excel workbook to values across all worksheets"
author: "Leon Shpaner"
date: "2020-12-27"
output: html_document
---

<link href="/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>


Copy the following code into the VBA Environment in excel:
<pre>
  <code>
  
Sub ConvertFormulasToValuesAllWorksheets()
    
    Dim ws As Worksheet, rng As Range
    For Each ws In ActiveWorkbook.Worksheets
    For Each rng In ws.UsedRange
        If rng.HasFormula Then
        rng.Formula = rng.Value
    End If
        Next rng
        Next ws

End Sub

  </code>
</pre>
