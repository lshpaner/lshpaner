---
title: "VBA - script for converting formulas in an excel workbook to values across all worksheets"
author: "Leon Shpaner"
date: "2021-05-01"
output: html_document
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


Copy the following code into the VBA Environment in excel:
<pre>
  <code>
  
Sub ConvertFormulasToValuesAllWorksheets()
    
    Dim ws As Worksheet, rng As Range
    For Each ws In ActiveWorkbook.Worksheets
    For Each rng In ws.UsedRange
        If rng.HasFormula Then
        rng.Formula = rng.Value
    End If
        Next rng
        Next ws

End Sub

  </code>
</pre>
